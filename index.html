<html>
	<head>
		<title>Algoritmo de Diffie Hellman</title>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" href="https://unpkg.com/purecss@2.0.5/build/pure-min.css" integrity="sha384-LTIDeidl25h2dPxrB2Ekgc9c7sEC3CWGM6HeFmuDNUjX76Ert4Z4IY714dhZHPLd" crossorigin="anonymous">
		<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Comfortaa" />
		<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans+JP" />
		<style type="text/css">
			* {
				font-family: 'Noto Sans JP';
			}
			.pure-menu {
				background-color: #5f5f5f;
				padding: 15px 10px;
			}
			.pure-menu a {
				color: white;
			}
			.step-label {
				font-size: 24px;
				line-height: 32px;
				vertical-align: bottom;
				margin-left: 10px;
			}
			.step-description {
				line-height: 24px;
				vertical-align: bottom;
				font-size: 20px;
			}
			footer {
				border-top: 1px solid gray;
				padding: 30px 15px;
				color: white;
				background-color: #5f5f5f;
			}
			footer a {
				color: white;
			}
			.success-step-3 {
				background-color: #12b912!important;
				color: white!important;
			}
			.button-success,
			.button-error,
			.button-warning,
			.button-secondary {
				color: white;
				border-radius: 4px;
				text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);
			}
			.button-success {
				background: rgb(28, 184, 65);
			}
		</style>
		<script type="text/javascript">
			window.onload = function() {
				var P = 23;
				var G = 9;
				
				var btnGenerateSharedKey = document.getElementById("btn-generate-shared-key");
				btnGenerateSharedKey.addEventListener("click", function() {
					var txtRandomNumber = document.getElementById("txt-random-number");
					
					var resultToShare = (G ** parseInt(txtRandomNumber.value)) % P;
					
					document.getElementById("tit-public-key").style.display = "block";
					var spanPublicKey = document.getElementById("span-public-key");
					spanPublicKey.innerHTML = resultToShare;
				});
				
				var btnAccept = document.getElementById("btn-accept");
				btnAccept.addEventListener("click", function() {
					var txtOtherUserKey = document.getElementById("txt-other-user-key");
					var txtRandomNumber = document.getElementById("txt-random-number");

					var sharedKey = (parseInt(txtOtherUserKey.value) ** (txtRandomNumber.value)) % P;
					var txtSharedKey = document.getElementById("txt-shared-key");
					txtSharedKey.value = sharedKey;
					txtSharedKey.classList.add("success-step-3");
				});
				
				var btnCipher = document.getElementById("btn-cipher");
				btnCipher.addEventListener("click", function() {
					var txtPlainText = document.getElementById("txt-plain-text");
					var txtSharedKey = document.getElementById("txt-shared-key");
					var rot = parseInt(txtSharedKey.value);
					var cipherText = caesar(txtPlainText.value, rot);
					var txtCipherText = document.getElementById("txt-cipher-text");
					txtCipherText.value = cipherText;
				});
				
				var btnDecipher = document.getElementById("btn-decipher");
				btnDecipher.addEventListener("click", function() {
					var txtTextToDecipher = document.getElementById("txt-text-to-decipher");
					var txtSharedKey = document.getElementById("txt-shared-key");
					var rot = parseInt(txtSharedKey.value);
					var cipherText = caesar(txtTextToDecipher.value, -rot);
					var txtDecipheredText = document.getElementById("txt-deciphered-text");
					txtDecipheredText.value = cipherText;
				});
				
				function caesar(text, rot) {
					return text.split('').map(c => {
						let mayus = (c === c.toUpperCase()) ? true : false;
						let valorEntero = c.toLowerCase().charCodeAt(0);
						if (valorEntero >= 97 && valorEntero <= 122) {
								
								if (valorEntero + rot > 122) {
									valorEntero = 97 + (valorEntero - 122) + rot - 1;
								} else if (valorEntero + rot >= 97) {
									valorEntero = valorEntero + rot;
								} else {
									valorEntero = 122 - (97 - (valorEntero + rot)) + 1;
								}
							}
					
							let cifrado = String.fromCharCode(valorEntero);
							return mayus ? cifrado.toUpperCase() : cifrado;
						}).join('');
				}
			}
		</script>
	</head>
	<body>
		<div class="pure-menu pure-menu-horizontal">
			<a href="#" class="pure-menu-heading" style="font-family: Comfortaa">Diffie Hellman</a>
		</div>
	
		<div style="padding: 10px 30px">
			<p>
				Diffie-Hellman es un algotirmo que permite ponerse de acuerdo de una clave en un medio inseguro.
				Por ejemplo, si estás en una reunión con varias personas pero solo con una de ellas quisieras compartir una clave
				incluso mientras los demás los están viendo, con este algoritmo lo puedes hacer.
			</p>
			<p>
				Este algoritmo se utiliza todo el tiempo cuando navegas por la web ya que se utiliza en el protocolo TLS (HTTPS).
			</p>

			<h3>
				Puedes probarlo a continuación...
			</h3>

			<div>
				<form class="pure-form">
					<fieldset>
						<legend>
							<img src="writing.png" width="32px" />
							<b class="step-label">Paso 1:</b>
							<span class="step-description">Ingresa un número entre 1 y 99 (¡Cuidado, no lo compartas!) y haz clic en el botón.</span>
						</legend>
						<input type="number" id="txt-random-number" style="width: 100px" />
						<button type="button" class="pure-button pure-button-primary" id="btn-generate-shared-key" >Generar clave para compartir</button>
					</fieldset>
					<h4 id="tit-public-key" style="display: none">
						El siguiente número es tu clave pública y puedes compartirla:
						<span id="span-public-key"></span>. Envía este número con quién desees generar una clave y espera que él te envíe la suya.
					</h4>
				</form>
			</div>
			
			<div>
				<form class="pure-form">
					<fieldset>
						<legend>
							<img src="key.png" width="32px" />
							<b class="step-label">Paso 2:</b>
							<span class="step-description">Ingresa la clave pública de la otra persona y haz clic en el botón.</span>
						</legend>
						<input type="number" id="txt-other-user-key" style="width: 100px" />
						<button type="button" class="pure-button pure-button-primary" id="btn-accept" >Generar clave secreta</button>
						<span id="span-public-key"></span>
					</fieldset>
				</form>
			</div>
			
			<div>
				<form class="pure-form">
					<fieldset>
						<legend>
							<img src="check.png" width="32px" />
							<b class="step-label">Paso 3:</b>
							<span class="step-description">A continuación tu clave (la misma obtendrá tu compañero).</span>
						</legend>
						<input type="number" id="txt-shared-key" disabled="disabled" style="width: 100px"/>
					</fieldset>
				</form>
			</div>
			
			<div>
				<form class="pure-form">
					<fieldset>
						<legend style="vertical-align: baseline;">
							<img src="email.png" width="32px" />
							<b class="step-label">Paso 4:</b>
							<span class="step-description">Envía un mensaje cifrado.</span>
						</legend>
						<input type="text" id="txt-plain-text" maxlength="26" />
						<button type="button" class="button-success pure-button" id="btn-cipher" >Cifrar</button>
						<input type="text" id="txt-cipher-text" disabled="disabled" style="background: white!important; color: black!important;" />
					</fieldset>
				</form>
			</div>
			
			<div>
				<form class="pure-form">
					<fieldset>
						<legend style="vertical-align: baseline;">
							<img src="message.png" width="32px" />
							<b class="step-label">Paso 5:</b>
							<span class="step-description">Recibe y lee un mensaje cifrado.</span>
						</legend>
						<input type="text" id="txt-text-to-decipher" maxlength="26"/>
						<button type="button" class="button-success pure-button" id="btn-decipher" >Descifrar</button>
						<input type="text" id="txt-deciphered-text" disabled="disabled" style="background: white!important; color: black!important;" />
					</fieldset>
				</form>
			</div>
		</div>
		
		<footer>
			<div style="text-align: right; font-family: 'Comfortaa'; margin-bottom: 5px;">
				E-Learning Tool
			</div>
			<div style="text-align: right; font-family: 'Comfortaa'; margin-bottom: 5px;">
				Powered by Pabex Academy
			</div>
			
			<div style="text-align: right; font-family: 'Comfortaa';">
				Los íconos fueron extraídos desde <a href="https://www.flaticon.com/" title="Flaticon" rel="noopener" target="_blank">www.flaticon.com</a>
			</div>
		</footer>
	</body>
</html>